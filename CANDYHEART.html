<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">

  <title>Document</title>
</head>
<body>


<div><video src="./audio/ECV.mp3" controls> </video></div>

<div>  </div>
<div><button id="bt1">СМЕНИТЬ КАНАЛ</></div>
<div>   </div>
<div><button id="bt2">сбросить фильтры</></div>
  <div>   </div>

<div><button id="bt3000">3000</></div>



  <script>
  document.getElementById('bt1').addEventListener('click',func)
  document.getElementById('bt2').addEventListener('click',nul)


document.getElementById('bt3000').addEventListener('click',pish3000)

var p=80;
function pish2000() {
  for (var i = 0; i <= 10; i++) {filters[i].gain.value=-25};
  filters[6].gain.value=p;
}
function pish3000() {
  for (var i = 0; i <= 10; i++) {filters[i].gain.value=-25};
  filters[7].gain.value=p;
}
function pish4000() {
  for (var i = 0; i <= 10; i++) {filters[i].gain.value=-25};
  filters[8].gain.value=p;
}
function pish6000() {
  for (var i = 0; i <= 10; i++) {filters[i].gain.value=-25};
  filters[9].gain.value=p;
}
function pish8000() {
  for (var i = 0; i <= 10; i++) {filters[i].gain.value=-25};
  filters[10].gain.value=p;
}

  window.AudioContext = window.AudioContext || window.webkitAudioContext;
var filter,filters=[];
  var context = new AudioContext();


var a=document.getElementsByTagName('video')[0];
var b=[]; b.push(a);
a.autoplay=true;


  var createFilter = function (frequency) {
    filter = context.createBiquadFilter();

    filter.type = 'peaking';
    filter.frequency.value = frequency;
    filter.Q.value = 1;
    filter.gain.value = 0;

    return filter;
  };

  var createFilters = function () {

var frequencies = [125,250,500,750,1000,1500,2000,3000,4000,6000,8000];
  filters = frequencies.map(createFilter);

    filters.reduce(function (prev, curr) {
      prev.connect(curr);
      return curr;
    });

    return filters;
  };

  var equalize = function (a) {
    var source = context.createMediaElementSource(a),
      filters = createFilters();
    source.connect(filters[0]);
    filters[filters.length - 1].connect(context.destination);
  };

  equalize(a);

var V=-5;
var v=1;
function func() {


V*=-1;
for (var i = 0; i <= 10; i++) {filters[i].gain.value=0};
for (var i = 5; i <= 10; i++) {filters[i].gain.value=V-v}for (var i = 3; i < 5; i++) {filters[i].gain.value=-V+v};
}


function nul() {
  for (var i = 0; i <= 10; i++) {filters[i].gain.value=0};
}
  </script>
</body>
</html>
