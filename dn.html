<!DOCTYPE html>
<html>
<meta charset="utf-8">
<head>
  
  
  <title>gapi</title>
<style>
  @font-face {
  font-family: rusja01;
  src: url('./3681.ttf');
  }
 #clear {width: 50%;height: 100px;}
 #save {width: 50%;height: 110px;}
</style>
<script src="https://apis.google.com/js/api.js"></script>

		
</head>
 <body>


<textarea  name="textarea" id="ta" style="font-family:rusja01;font-size:50px;width:100%;" rows="4" cols="auto"></textarea>
<button id='save' onclick='save()'>SAVE</button>
<button id='clear' onclick='clr()'>clr</button>

<script>
var ta=document.getElementsByName("textarea");
				ta[0].focus();

function save(){fs(ta[0].value)};	
function clr(){start()};

function fs(PECH){
var text = PECH;
//const text=JSON.stringify(PECH);
		 const blob = new Blob([text], {type: "text/plain;charset=UTF-8"});
			const anchor = document.createElement('A');
		anchor.download ="file.txt";
		anchor.href = (window.webkitURL || window.URL).createObjectURL(blob);
		anchor.dataset.downloadurl = ['text/plain', anchor.href].join(':');
		anchor.click();
		
		
	};			
 
const start = () => {gapi.client.init({
    'apiKey': '{AIzaSyB6aEYUWsr2-UVwITCdhL7Nm2zGNnXQ9MM}',
    'discoveryDocs': ["https://sheets.googleapis.com/$discovery/rest?version=v4"],
  }).then(() => {
    return gapi.client.sheets.spreadsheets.values.get({
      spreadsheetId: '{17gLBVdOkI9dN_FjeG819l1naQPPdUnJz_g6KwS8RoV8}',
      range: 'List 1!A1:E1', // for example: List 1!A1:B6
    })
  }).then((response) => {
    
    console.log(response)})
		    
		    };

gapi.load('client', start);	 
function rq(){var xhttp = new XMLHttpRequest();
xhttp.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
       console.log(xhttp.responseText);
    }
};
xhttp.open("GET", "https://script.google.com/macros/s/AKfycbye7_8hphpv1numF_rG9TTQisriauc_y5LODNhMRXTs9ExhAd6OfiiWzUsBDwUANG33/exec", true);
xhttp.send();}
		</script>

</body>
</html>
