<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8" />

<style>
.veer{
position:fixed;
width:100%;
height:0%;
bottom:0%;
left: -5%;
transform-origin: 50% 80% 0;
}
.pole{
position:fixed;
width:110px;
height:200px;
border: 4px double black;
border-radius:5%;
bottom:200px;
left:300px;
transform-origin: 50% 100% 0;
background-color: #FF7373;

}
#win{
position: fixed;
width:600px;
height:540px;
border: 4px double black;
border-radius:5%;
background-color: green;
z-index: -10;
}
.sk{background-color: blue;border-radius: 50%;}
.coloda{

	position: fixed;
	width:150px;
	height:100px;
	top:20px;
	left:120px;
	border: 4px double black;
	border-radius:5%;
	background-color: blue;
}

</style>
</head>
<body>
<div id='win'>
<div class='veer'></div>
<div class='veer'></div>
<div class='veer'></div>
<div class='coloda'></div><div class='coloda'></div><div class='coloda'></div>
</div>
<script>

var zi=0;var sm=0;
 stol=document.getElementsByClassName('veer');
 pole=document.getElementsByClassName('pole');
 win=document.getElementById('win');
 coloda=document.getElementsByClassName('coloda');
 coloda[1].style.left='280px';coloda[2].style.left='440px';
stol[0].py=+window.getComputedStyle(stol[0]).getPropertyValue('bottom').slice(0,-2);ty(stol[0],-200);
stol[1].py=+window.getComputedStyle(stol[1]).getPropertyValue('bottom').slice(0,-2);ty(stol[1],-200);
stol[2].py=+window.getComputedStyle(stol[2]).getPropertyValue('bottom').slice(0,-2);ty(stol[2],-200);
stol[0].rot=0;stol[1].rot=0;stol[2].rot=0;
stol[0].px=+window.getComputedStyle(stol[0]).getPropertyValue('left').slice(0,-2);tx(stol[0],0)
stol[1].px=+window.getComputedStyle(stol[1]).getPropertyValue('left').slice(0,-2);tx(stol[1],0);
stol[2].px=+window.getComputedStyle(stol[2]).getPropertyValue('left').slice(0,-2);tx(stol[2],0);



function shirKvis(i){i.style.width=`${i.getBoundingClientRect().height/2}px`}
//window.addEventListener( 'resize', ps, false );//ps();
function ps(){
  Array.prototype.forEach.call(pole,(i)=>{shirKvis(i)})
};

function dk(){
						if (zi<12)s=stol[0];if (zi>=12)s=stol[1];if (zi>=24)s=stol[2];
						s.appendChild(document.createElement('div')).className='pole';
						var p=pole[pole.length-1];
					  p.rot=0;
						s.addEventListener('mouseout',zatem,true);s.addEventListener('mouseover',osvet,true);
            p.px=+window.getComputedStyle(p).getPropertyValue('left').slice(0,-2);
						p.py=+window.getComputedStyle(p).getPropertyValue('bottom').slice(0,-2);
            p.style.zIndex=zi;p.zi=zi;zi++;


						//p.onmouseup = function() {p.onmouseup = null; };
						p.onmousedown = function(event) {pero=p;

							win.append(p);
							p.style.position = 'absolute';
							p.px=+window.getComputedStyle(p).getPropertyValue('left').slice(0,-2);
							p.py=+window.getComputedStyle(p).getPropertyValue('bottom').slice(0,-2);
							p.ix = p.px-event.clientX;
							p.iy = p.py-event.clientY;
							p.style.left = event.clientX +'px';
							//p.style.bottom= event.clientY +'px';
console.log(event.clientX,p.px,p.ix,p.style.left);


						  //moveAt(event.pageX, event.pageY,ball);
						}
						//p.onmouseup = function() {document.removeEventListener('mousemove', onMouseMove);}
						p.ondragstart = function() { return false};
    				//p.onmouseup = null



            veer(p,s);

            }
var pero={};pero.ix=0;pero.iy=0;pero.style=0;pero.style=0;
document.addEventListener('mousemove', onMouseMove);
function onMouseMove(event){

	//pero.style.left = event.pageX-pero.ix +'px';
	//pero.style.bottom= event.pageY-pero.iy +'px';
	//pero.px=+window.getComputedStyle(pero).getPropertyValue('left').slice(0,-2);
	//pero.py=+window.getComputedStyle(pero).getPropertyValue('bottom').slice(0,-2);
}

              //if(12<zi<24){ty(pole[pole.length-1]);};



function veer(e,s){
	if (s==stol[0])ss=0;if (s==stol[1])ss=12;if (s==stol[2])ss=24;
	rot(e,(zi-ss)*10);
	tx(e,(zi-ss)*10);rot(s,-4);ty(s,5);
	if(ss==12){ty(stol[0],5)}if(ss==24){ty(stol[0],5);ty(stol[1],5);}
};




function rot (e,g){e.rot+=g; e.style.transform=`rotate(${e.rot}deg)`}

function ty(e,y){e.py+=y;e.style.bottom=e.py+'px'}
function tx(e,x){e.px+=x;e.style.left=e.px+'px'}
itc=0;
interval=setInterval(()=>{dk();itc++;if(itc>=5)clearInterval(interval)},50);

function osvet(e) {e.path[0].style.backgroundColor='#FFC3C3'}
function zatem(e){e.path[0].style.backgroundColor='#FF7373'}







//pole[0].style.width=`${pole[0].getBoundingClientRect().height/20}px`
//# sourceURL=userscript.js
</script>
</body>
</html>
